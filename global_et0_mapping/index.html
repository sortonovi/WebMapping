<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webcarto - Global ET0</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        /* ... ton code CSS ici ... */
    </style>
</head>
<body>
    <div id="header-banner">Global ET0 (1970-2000)</div>

    <div id="map"></div>

    <div id="controls">
        <div id="current-month">ET0 moyenné : Janvier</div>
        <button id="play-pause">▶ Lecture</button>
    </div>

    <div id="legend">
        <!-- ... ton code pour la légende ici ... -->
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const map = L.map('map', { maxZoom: 5, minZoom: 5 }).setView([20, 0], 5);

        const googleSatellite = L.tileLayer('https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
            subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
            attribution: 'Map data ©2024 Google',
            maxZoom: 20
        }).addTo(map);

        const layers = [
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/january_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/february_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/march_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/april_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/may_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/june_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/july_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/august_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/september_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/october_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/november_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 }),
            L.tileLayer('https://sortonovi.github.io/webmapping/global_et0_mapping/december_tiles/{z}/{x}/{y}.png', { tms: true, opacity: 0 })
        ];

        const months = [
            "Janvier", "Février", "Mars", "Avril", "Mai", "Juin",
            "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"
        ];

        let currentLayerIndex = 0;
        let interval;
        const playPauseButton = document.getElementById('play-pause');
        const currentMonthLabel = document.getElementById('current-month');

        layers.forEach((layer, index) => {
            layer.addTo(map);
            if (index === 0) layer.setOpacity(1);
            else layer.setOpacity(0);
        });

        function transitionToNextLayer() {
            const currentLayer = layers[currentLayerIndex];
            const nextLayerIndex = (currentLayerIndex + 1) % layers.length;
            const nextLayer = layers[nextLayerIndex];

            let opacity = 0;
            const fadeInterval = setInterval(() => {
                opacity += 0.02;
                currentLayer.setOpacity(1 - opacity);
                nextLayer.setOpacity(opacity);

                if (opacity >= 1) {
                    clearInterval(fadeInterval);
                    currentLayerIndex = nextLayerIndex;
                    currentMonthLabel.textContent = `ET0 moyenné : ${months[currentLayerIndex]}`;
                }
            }, 35);
        }

        function playAnimation() {
            interval = setInterval(() => transitionToNextLayer(), 5000);
            playPauseButton.textContent = '❚❚ Pause';
        }

        function pauseAnimation() {
            clearInterval(interval);
            playPauseButton.textContent = '▶ Lecture';
        }

        playPauseButton.addEventListener('click', () => {
            if (interval) pauseAnimation();
            else playAnimation();
        });

        playAnimation();

        fetch('https://sortonovi.github.io/webmapping/global_et0_mapping/tm_world_borders.geojson')
            .then(response => response.json())
            .then(data => {
                L.geoJSON(data, {
                    style: {
                        color: '#000',
                        weight: 1,
                        fillOpacity: 0
                    },
                    onEachFeature: (feature, layer) => {
                        if (feature.properties && feature.properties.name) {
                            layer.bindPopup(`Pays : ${feature.properties.name}`);
                        }
                    }
                }).addTo(map);
            })
            .catch(error => console.error('Erreur lors du chargement du GeoJSON :', error));
    </script>
</body>
</html>
